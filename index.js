let account;const initializeMina=async()=>{const e=document.getElementById("connectButton"),n=document.getElementById("getAccounts"),t=document.getElementById("getAccountsResult");e.onclick=async()=>{if(window.mina){e.innerText="Onboarding in progress";let n=await window.mina.requestAccounts().catch((e=>e));if(n.message)e.innerText=n.message;else{let t=n;account=t,document.getElementById("accounts").innerHTML=t,e.innerText="Connected",e.disabled=!0}}else alert("No provider was found 请先安装 Auro Wallet")},n.onclick=async()=>{if(window.mina){let e=await window.mina.requestAccounts().catch((e=>e)),n=e;e.message?t.innerHTML=e.message:t.innerHTML=n}};const a=document.getElementById("sendButton"),c=document.getElementById("sendAmountInput"),i=document.getElementById("receiveAddressInput"),o=document.getElementById("sendResultDisplay");a.onclick=async()=>{let e=account&&account.length>0?account[0]:"",n=await window.mina.sendPayment({amount:c.value,from:e,to:i.value}).catch((e=>e));n.hash?o.innerHTML=n.hash:o.innerHTML=n.message};const s=document.getElementById("stakingButton"),d=document.getElementById("vaildatorAddressInput"),u=document.getElementById("stakingResultDisplay");s.onclick=async()=>{let e=account&&account.length>0?account[0]:"",n=await window.mina.sendStakeDelegation({from:e,to:d.value}).catch((e=>e));n.hash?u.innerHTML=n.hash:u.innerHTML=n.message};const l=document.getElementById("signMessageButton"),m=document.getElementById("signMessageContent"),g=document.getElementById("signMessageResult"),r=document.getElementById("signVerifyButton"),y=document.getElementById("verifyResult");let w;l.onclick=async()=>{let e=account&&account.length>0?account[0]:"";w=await window.mina.signMessage({from:e,message:m.value}).catch((e=>e)),w.signature?g.innerHTML=JSON.stringify(w.signature):g.innerHTML=w.message},r.onclick=async()=>{let e=account&&account.length>0?account[0]:"",n=await window.mina.verifyMessage({publicKey:e,signature:{field:w?.signature?.field,scalar:w?.signature?.scalar},payload:m.value}).catch((e=>e));y.innerHTML=n},setTimeout((async()=>{window.mina&&(window.mina.on("accountsChanged",I),window.mina.on("chainChanged",B),B(await window.mina.requestNetwork().catch((e=>e))))}),200);const h=document.getElementById("network");function B(e){h.innerHTML=e}function I(n){Array.isArray(n)&&(document.getElementById("accounts").innerHTML=n,0===n.length&&(e.innerText="Connect",e.disabled=!1))}};window.addEventListener("DOMContentLoaded",initializeMina);